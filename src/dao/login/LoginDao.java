package dao.login;

import static db.JdbcUtil.*;
import javax.sql.*;
import java.sql.*;
import java.util.*;
import vo.*;

public class LoginDao {
// �슖�돦裕꾬옙�쟽�뜝�럩逾� 占쎄슈�뜝�룞�삕占쎌죨 占쎈쐩占쎈닑占쎈뉴占쎈ご�뜝占� �뜝�럡臾멨뜝�럡�뎽�뜝�럥由��뜝�럥�뿰 �뜝�럥堉꾢뜝�럥六у뜝�럥六삣뜝�럡�뀞�뜝�럥裕� �뜝�럡源삣뜝�럩�굥�뜝�럥裕�
	private static LoginDao loginDao;
	// �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕� 嶺뚮、�걞�떋占썸뤆�룊�삕 �뜝�럥�닡�뜝�럥鍮� �뜝�럡源삣뜝�럩�굥�뜝�럥裕� 嶺뚮、�걞�떋占썲슖�댙�삕 loginDao �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욑옙紐닷뜝占� �뜝�럡�맖�뜝�럥�꽘�뜝�럥留쇿뜝�럩紐드슖�돦裕뉛옙�몗 �뜝�럥�뿰�뜝�럩�몠 �뤆�룇裕꾢뜝占� �뜝�럥�닡�뜝�럥鍮� �뜝�럥由��뜝�럡�룎嶺뚮엪�삕 �댖怨뺣샍占쎌궨�뜝�럥由��뇦猿볦삕 �뜝�럥彛�
	private Connection conn;
	// �뜝�럡源삣뜝�럩�굥�뜝�럥裕� �뜝�럩�쓧嶺뚳퐢�샍�굢�맮�삕�땻占� Connection �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕� conn�뜝�럩諭� �뜝�럡�뀬�뜝�럩�뮔�뜝�럥留� �뜝�럥�빢 �뜝�럩肉녜뇦猿볦삕 �뜝�럥彛�
	private LoginDao() {}
	// �뜝�럩�뇶占쎄껀�뜝�룞�삕�굢�맮�삕�땻占� 嶺뚯쉳�궚占쎌젘�뜝�럩�쓤�뜝�럩紐드슖�댙�삕 �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욑옙紐닷뜝占� �뜝�럡臾멨뜝�럡�뎽�뜝�럥由��뜝�럥裕� �뇦猿볦삕(new �뜝�럡�뀞�뜝�럩�쐳�뜝�럥援� �뜝�럡�뀬�뜝�럩�뮔)�뜝�럩諭� 嶺뚮씭留��뵳占� �뜝�럩留꾢뜝�럥�돵 private�뜝�럩紐드슖�댙�삕 �뼨轅명�∽옙沅� �뜝�럡臾멨뜝�럡�뎽�뜝�럩�겱占쎈ご�뜝占� �뜝�럡�맖�뜝�럥�꽘

	public static LoginDao getInstance() {
	// �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욑옙紐닷뜝占� �뜝�럡臾멨뜝�럡�뎽�뜝�럥�돵�썒�슣�닑占쎈츎 嶺뚮∥�뾼占쎄틬�뜝�럥援▼슖�댙�삕 �뜝�럥由��뜝�럡�룎�뜝�럩踰� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욅춯�엪�삕 �뜝�럡臾멨뜝�럡�뎽�뜝�럥六삣뜝�럡��(singleton �뛾�렮維쀯옙六�)
	// DB�뜝�럩�굚�뜝�럥�뵜�뜝�럩諭� 嶺뚮씭�섓옙逾� �뜝�럥由��뜝�럥裕� �뜝�럡源삣뜝�럩�굥�뜝�럥裕� �뜝�럥諭잌뜝�럡�뎽�뜝�럡留� �뜝�럥�뿰�뜝�럩�몠 �뤆�룇裕뉛옙踰� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욄뤆�룊�삕 �뜝�럡臾멨뜝�럡�뎽�뜝�럥�뵹嶺뚮〕�삕 �윜諛몄굡壤쏅톪�삕野껓옙 
	// 嶺뚮씭�섇뜝占� �뜝�럥�빢�뜝�럩踰� DB�뜝�럥�뿼�뇦猿볦삕(Connection)�뜝�럩逾� �뜝�럡臾며뼨轅명�▼뜝�뜽�뿉�뜝占� �뜝�럩�쓧嶺뚳퐢�샍占쎌쓤�뜝�럩逾� �뜝�럥爰쀥뜝�럥利� �뜝�룞�삕�뜝�럥由��뜝�럩踰� �뜝�럩�뮡�뜝�럩�졎�뤆�룊�삕 �뜝�럩肉녑뜝�럥�꽑 �뜝�럥堉볡뼨�먯삕�뜝�럥苑� �뛾�렮維쀯옙六쇔뜝�럩諭� �뜝�럡�뀬�뜝�럩�뮔
		if (loginDao == null) {
		// 嶺뚮、�걞�떋占썲슖�댙�삕 �뜝�럡�맖�뜝�럥�꽘�뜝�럥彛� LoginDao �뜝�럩援� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕� loginDao�뤆�룊�삕 null�뜝�럩逾좂춯濡녹삕(�뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욄뤆�룊�삕 �뜝�럡臾멨뜝�럡�뎽�뜝�럥�뵹嶺뚯쉻�삕 �뜝�럥瑜ュ뜝�럥由��뜝�럩紐든춯濡녹삕)
			loginDao = new LoginDao();
			// �뜝�럡臾멨뜝�럡�뎽�뜝�럥彛� loginDao �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕욄뤆�룊�삕 �뜝�럥�뵪�뜝�럩紐득쾬�꼻�삕�슖�댙�삕 �뜝�럡�돮�슖�댙�삕�뇦猿볦삕 �뜝�럥由��뜝�럡�룎 �뜝�럡臾멨뜝�럡�뎽�뜝�럥留�
		}
		return loginDao;
	}
	public void setConnection(Connection conn) {
	// LoginSvc �뜝�럡源삣뜝�럩�굥�뜝�럥裕욃뜝�럥�뱺�뜝�럡�맋 �솻洹ｏ옙亦낉옙 Connection�뤆�룇鍮섊뙼�뮁紐닷뜝占� �뛾�룇猷뉔뇡占� 嶺뚮、�걞�떋占썲뜝�럩逾� conn�뜝�럥�뱺 �뜝�룞�삕�뜝�럩�궋
	// �뜝�럩�뇶占쎄껀�뜝�룞�삕�굢�맮�삕�땻占� Connection �뤆�룇鍮섊뙼�뮁紐닷뜝占� �뛾�룇猷놅옙裕� �뜝�럩逾졾뜝�럩占썲뜝�럥裕� DB�뜝�럩�굚�뜝�럥�뵜�뜝�럩逾� �뜝�럥�뿰�뜝�럩�몠 �뵓怨뺣쐠占쎈뎄 �뇦猿뗫윪占쎈뮡 
	// Connection �뤆�룇鍮섊뙼�뮁紐닷뜝占� �뜝�럥�뿰�뜝�럩�몠 �뵓怨ㅼ삕 �뜝�럡臾멨뜝�럡�뎽�뜝�럥由��뜝�럥裕� �뇦猿됲뜑占쎈굵 嶺뚮씭留��뵳占� �뜝�럩留꾢뜝�럥�돵 嶺뚮、�걞�떋占썲슖�댙�삕 嶺뚯쉻�삕�뜝�럩�젧�뜝�럥由��뜝�럥�뿰 �뜝�럡�뀬�뜝�럩�뮔
		this.conn = conn;
	}
	public MemberInfo getLoginMember(String uid, String pwd) {
	// �뜝�럡�뀬�뜝�럩�뮔�뜝�럩�겱�뤆�룊�삕 �뜝�럩肉��뜝�럩�졑�뜝�럥由� �뜝�럥�닡�뜝�럩逾졾뜝�럥�꺏�뜝�룞�삕 占쎈쑏熬곣뫅�삕�뵓怨뺣쐡占쎄퉰占쎈ご�뜝占� �뜝�럩逾졾뜝�럩�뮔�뜝�럥由��뜝�럥�뿰 �슖�돦裕꾬옙�쟽�뜝�럩逾� �뜝�럩�쐩 �뜝�럥�닡�뜝�럩�뭵�뜝�럥由� �뜝�럡�뀬�뜝�럩�뮔�뜝�럩�겱�뜝�럩�젧�솻洹ｏ옙�뜝�룞�삕 占쎈퉲�겫�슧�긷뜝�럥由��뜝�럥�뿰 MemberInfo �뜝�럩援ⓨ뜝�럩紐드슖�댙�삕 占쎈뎨占쎈뿪�돇�뜝�럥由��뜝�럥裕� 嶺뚮∥�뾼占쎄틬�뜝�럥援�
		MemberInfo loginMember = null;	// �슖�돦裕꾬옙�쟽�뜝�럩逾� �뜝�럩�쐩 �뜝�럡�뀬�뜝�럩�뮔�뜝�럩�겱�뜝�럩�젧�솻洹ｏ옙�뜝�룞�삕 �뜝�룞�삕�뜝�럩�궋�뜝�럥留� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕�
		Statement stmt = null;
		ResultSet rs = null;
		try {
		// DB占쎄슈�뜝�룞�삕占쎌죨 �뜝�럩�굚�뜝�럥�뵜�뜝�럥�뱺�뜝�럡�맋�뜝�럥裕� �뜝�룞�삕占쎄껀�뜝�띂寃ヨ쥈�뫗踰� 嶺뚮∥�뾼占쎄틬�뜝�럥援→뤆�룊�삕 'throws SQLException'�슖�댙�삕 �뜝�럡�맖�뜝�럥�꽘�뜝�럥�뵹�뜝�럥�꽑 �뜝�럩肉녕뼨�먯삕 �뜝�럥瑜댐옙�닱筌뤾쑬�뱺 �뜝�럩援쇿뜝�럩�뇶嶺뚳퐣瑗띰옙遊븝옙紐닷뜝占� �뜝�럥�돵�뜝�럥�뒍 �뜝�럥留� 
			stmt = conn.createStatement();
			String sql = "select * from t_member_info where " + 
				"mi_id = '" + uid + "' and mi_pwd = '" + pwd + "' "  ;
			System.out.print("getLoginMember : " + sql);
			rs = stmt.executeQuery(sql);

			if (rs.next()) {	// �슖�돦裕꾬옙�쟽�뜝�럩逾� �뜝�럡�뎽占썩뫀踰딉옙六�
				loginMember = new MemberInfo();	// �슖�돦裕꾬옙�쟽�뜝�럩逾� �뜝�럡�뎽占썩뫀踰딉옙六삣뜝�럥�뱺嶺뚮엪�삕 �뜝�럡臾멨뜝�럡�뎽�뜝�럥�뵹�뜝�럥裕� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕�
				// �슖�돦裕꾬옙�쟽�뜝�럩逾� �뜝�럥堉꾢뜝�럥�넮�뜝�럥六삣뜝�럥�뱺�뜝�럥裕� loginMember�뤆�룊�삕 占쎈쑏熬곣뫖�꽑 �뜝�럩肉녑뜝�럥裕� �뜝�럡留믣뜝�럡臾�(null)�슖�댙�삕 占쎈뎨占쎈뿪�돇�뜝�럥�뵹�뇦猿볦삕 �뜝�럥留�

				loginMember.setMi_id(uid);
				loginMember.setMi_pwd(pwd);
				loginMember.setMi_name(rs.getString("mi_name"));
				loginMember.setMi_birth(rs.getString("mi_birth"));
				loginMember.setMi_gender(rs.getString("mi_gender"));
				loginMember.setMi_phone(rs.getString("mi_phone"));
				loginMember.setMi_email(rs.getString("mi_email"));
				loginMember.setMi_issns(rs.getString("mi_issns"));
				loginMember.setMi_ismail(rs.getString("mi_ismail"));
				loginMember.setMi_pic(rs.getString("mi_pic")); 
				// MemberInfo �뜝�럡源삣뜝�럩�굥�뜝�럥裕욃뜝�럩踰� �뜝�럩逾ε뜝�럥裕욃뜝�럡�돇�뜝�럥裕� loginMember�뜝�럥�뱺 �뜝�럩�뤂�뜝�럩�쐸�뜝�럩�젧�솻洹ｏ옙獄��뼅占썩뫅�삕 �뼨轅명�∽옙沅싮썒�슣�닔占쎄틬占쎈ご�뜝占� �뜝�룞�삕�뜝�럩�궋
			}

		} catch(Exception e) {
			System.out.println("getLoginMember() 嶺뚮∥�뾼占쎄틬�뜝�럥援� �뜝�럩沅롳옙紐닷뜝占�");
			e.printStackTrace();
		} finally {
			close(rs);	close(stmt);
		}

		return loginMember;
	}
}
